# コンポーネントのコロケーション構造

```
comp/
├── index.ts                 # バレルエクスポート
├── comp.tsx                 # comp 本体（Props の型も合わせて定義）
├── comp.stories.tsx         # comp の Storybook
├── comp.test.tsx            # comp のテスト
├── sub-comp-1.tsx           # comp 内でのみ使用するコンポーネント1（Props の型も合わせて定義）
├── sub-comp-1.stories.tsx   # comp 内でのみ使用するコンポーネント1 Storybook
├── sub-comp-1.test.tsx      # comp 内でのみ使用するコンポーネント1のテスト
├── sub-comp-2.tsx           # comp 内でのみ使用するコンポーネント2（Props の型も合わせて定義）
├── sub-comp-2.stories.tsx   # comp 内でのみ使用するコンポーネント2 Storybook
├── sub-comp-2.test.tsx      # comp 内でのみ使用するコンポーネント2のテスト
├── hooks.ts                 # comp に閉じるカスタムフックを定義
├── hooks.test.ts            # comp に閉じるカスタムフックのテスト
├── utils.ts                 # comp に閉じるユーティリティ関数を定義
├── utils.test.ts            # comp に閉じるユーティリティ関数のテスト
├── schemas.ts               # comp に閉じる zod スキーマ、enum を定義
└── contexts/                # comp に閉じる context 定義（複雑化・肥大化したときのみ）
    ├── index.ts             # context のバレルエクスポート
    ├── context.ts           # createContext, useContext, 型定義
    ├── provider.tsx         # Context の Provider コンポーネント
    └── reducer.ts           # useReducer でのロジック管理（必要に応じて）
```

## ファイル作成の優先順位

**必須ファイル:**

- `index.ts` - バレルエクスポート（パブリックAPI）
- `comp.tsx` - メインコンポーネント（Props型定義含む）

**条件付きファイル:**

- `xxxx.stories.tsx` → Storybook 使用時
- `xxxx.test.tsx` → テストが必要な時
- `schemas.ts` → コンポーネント専用バリデーション・enumがある時
- `utils.ts` → コンポーネント専用ユーティリティがある時
- `hooks.ts` → コンポーネント専用フックがある時
- `contexts/` → 状態管理が複雑になった時

## index.ts のエクスポートルール

### **エクスポート順序**

1. メインコンポーネント
2. 型・enum（schemas.ts から）
3. スキーマ（バリデーション用）
4. サブコンポーネント（上級者用）
5. Context・hooks（カスタム実装用）

### **例:**

```typescript
export * from './video-editor';
export * from './schemas';
export * from './video-editor-canvas';
export * from './video-editor-control';
export * from './contexts';
```

## schemas.ts のルール

### **基本原則**

- コンポーネント専用の型・バリデーション・enumのみ定義
- グローバルに使用される型は `app/types/` に配置
- zodスキーマから型を推論 (`z.infer<typeof schema>`)

### **enum定義**

- TypeScript as const として定義・エクスポート
- zodスキーマでは `z.enum(EnumName)` を使用（zod 4以降）
- 命名規則: PascalCase（例: `TextAlign`, `VideoFormat`）

### **スキーマ定義**

- 各スキーマには適切なバリデーションを追加
- オプショナルフィールドは `.optional()` を使用
- 数値は適切な範囲制限を設定（例: `.min(0).max(1)` for volume）

### **型エクスポート**

- zodスキーマから推論された型をエクスポート
- 型名はスキーマ名から "Schema" を除いた形（例: `videoProjectSchema` → `VideoProject`）
